{% extends "base.html" %}

{% block title %}{{ draft.title }} (Draft) | Ecobank{% endblock %}

{% block meta %}
    <meta name="robots" content="noindex">
    <meta name="description" content="{{ _('Preview draft: %(title)s', title=draft.title) }}">

    <meta property="og:type" content="article">
    <meta property="og:title" content="[Draft] {{ draft.title }}">
    <meta property="og:description" content="{{ _('This is a draft post on Ecobank.') }}">
{% endblock %}

{% block content %}
    <div class="row mb-3">
        <div class="col-md-8">
            <h2>{{ draft.title }} <span class="badge bg-secondary">{{ draft.status }}</span></h2>
            <p class="text-muted">
                {{ _('By') }} {{ author.display_name }} | {{ _('For account:') }} @{{ draft.hive_account_username }}
            </p>
        </div>
        <div class="col-md-4 text-end">
            <div class="btn-group" role="group">
                {% if draft.status == 'draft' %}
                    {% if can_edit %}
                        <a href="{{ url_for('drafts.edit', draft_id=draft.id) }}" class="btn btn-outline-primary">{{ _('Edit') }}</a>
                    {% endif %}

                    {% if can_submit %}
                        <form action="{{ url_for('drafts.submit', draft_id=draft.id) }}" method="POST" class="d-inline" onsubmit="return confirm('{{ _('Are you sure you want to publish this to Hive? This cannot be undone.') }}');">
                            <button type="submit" class="btn btn-success">{{ _('Publish') }}</button>
                        </form>
                    {% endif %}

                    {% if can_delete %}
                        <form action="{{ url_for('drafts.reject', draft_id=draft.id) }}" method="POST" class="d-inline" onsubmit="return confirm('{{ _('Are you sure you want to reject/delete this draft?') }}');">
                            <button type="submit" class="btn btn-danger">{{ _('Reject') }}</button>
                        </form>
                    {% endif %}

                {% elif draft.status == 'published' %}
                    <a href="https://hive.blog/@{{ draft.hive_account_username }}/{{ draft.permlink }}" target="_blank" class="btn btn-info">{{ _('View on Hive') }}</a>
                {% endif %}
                <a href="{{ url_for('drafts.history', draft_id=draft.id) }}" class="btn btn-secondary">{{ _('History') }}</a>
                <a href="{{ url_for('groups.view', id=draft.group_id) }}" class="btn btn-secondary">{{ _('Back') }}</a>
            </div>
        </div>
    </div>

    <hr>

<!-- Preview of Automatic Header -->
    <div class="card mb-4 bg-light border-info">
        <div class="card-body">
            <h5 class="card-title text-info">{{ _('Automatic Header Preview') }}</h5>
            <p class="small text-muted">{{ _('This will be prepended to your post upon submission.') }}</p>
            <table>
                <tr>
                    <td>
                        <center><img src="{{ author.avatar_url or url_for('static', filename='img/user-circle-svgrepo-com.svg') }}" class="author-avatar"/></center>
                    </td>
                    <td>
                        <span><h4>{{ _('About the Author') }}</h4></span>
                        <div><span><strong>{{ author.display_name }}</strong></span> -
                            <span>{{ author.bio or _('Member of %(group)s', group=draft.group.name) }}</span></div>
                    </td>
                </tr>
            </table>
        </div>
    </div>

    <div class="card">
        <div class="card-header">{{ _('Content Preview') }}</div>
        <div class="card-body">
            {{ rendered_body }}
        </div>
    </div>
{% endblock %}